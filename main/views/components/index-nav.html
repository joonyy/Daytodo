<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script src="https://code.jquery.com/jquery-3.7.1.min.js" integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
  <title>D2D</title>  
  <link rel="stylesheet" href="/main/static/styles/index.css">
  <link rel="stylesheet" href="/main/static/styles/NAV-1.css">
  <style>
    body{
      overflow: hidden;
    }
    #calendar-body {
  height: 20px; /* 화면 높이에서 헤더와 버튼 컨테이너의 높이를 뺀 크기로 설정 */
} 
  </style>
</head>
<body>
  <header>
    <h1>DayTodo</h1>
    <a href="#" class="login">Login</a>
    <div class="login-popup" style="display: none;">
      <div class="popup-content">
        <span class="close-btn" onclick="closeLoginPopup()">&times;</span>
        <div class="login-container">
          <h2>DayTodo</h2>
          <form>
            <input type="text" placeholder="아이디 :" name="username" required>
            <input type="password" placeholder="비밀번호 :" name="password" required>
            <input type="submit" value="Login" class="login-detail">
          </form>
          <p class="signup-q">아직 회원이 아니신가요?</p>
          <div class="signup-link">
            <p><a href="#" class="signup-link">회원가입 Click</a></p>
          </div>
        </div>
      </div>
    </div>
    
    <!-- Signup Popup -->
    <div class="signup-popup" style="display: none;">
      <div class="popup-content">
        <span class="close-btn" onclick="closeSignupPopup()">&times;</span>
        <h2>회원가입</h2>

        <form class="signupform" onsubmit="return validateForm()">
          <label for="username">아이디:</label>
          <input type="text" id="username" name="username" pattern="[a-zA-Z0-9]{4,12}" title="영어와 숫자만 입력 가능하며, 4글자 이상 12글자 이하로 입력하세요." required>
          
          <label for="password">비밀번호:</label>
          <input type="password" id="password" name="password" pattern=".{6,}" title="6자 이상 입력하세요." required>
          
          <label for="nickname">닉네임:</label>
          <input type="text" id="nickname" name="nickname" pattern=".{2,8}" title="2글자 이상 8글자 이하로 입력하세요." required>
          
          <input type="submit" value="가입하기">
        </form>
      </div>
    </div>
  </header>
  <aside class="side-bar">
    <section class="side-bar__icon-box">
      <section class="side-bar__icon-1">
        <div></div>
        <div></div>
        <div></div>
      </section>
    </section>
    <ul>
      <li>
        <a href="#"><i class="fa-solid fa-cat"></i>Create Todo</a>
      </li>
      <li>
        <a href="#">View Todo</a>
      </li>
      <li>
        <a href="#">My page</a>
      </li>
    </ul>
  </aside>
<!-- nav.html종료 -->
<!-- index 시작 -->
<div class="btn-container">
  <button id="prevMonth" class="before" onclick="previousMonth()">&laquo;</button>
  <h2 class="yearMonth"></h2>
  <button id="nextMonth" class="after" onclick="nextMonth()">&raquo;</button>
</div>
<table>
<thead>
<tr>
  <th>일</th>
  <th>월</th>
  <th>화</th>
  <th>수</th>
  <th>목</th>
  <th>금</th>
  <th>토</th>
</tr>
</thead>
<tbody id="calendar-body">
  
</tbody>
</table>

<script>
let chosenDate = new Date(); // 선택된 날짜 : (오늘 날짜 :default)
let chosenYear = chosenDate.getFullYear(); // 선택된 해
let chosenMonth = chosenDate.getMonth();//선택된 달(0 : 1월, 1:2월 , ...)
let firstDate, lastDate, daysInMonth, firstDayOfMonth, lastDayOfMonth, weekCount;

const renderCalendar = () =>{ // 달력 출력 함수
  firstDate = new Date(chosenYear, chosenMonth, 1); // 선택된 달 첫날. 일 정보
  lastDate = new Date(chosenYear, chosenMonth + 1 , 0); // 선택된 달 마지막 날 일 정보
  daysInMonth = lastDate.getDate(); // 이번달 일 수(마지막 일)
  firstDayOfMonth = firstDate.getDay(); // 첫째 날의 요일 출력. (0 : 일요일, 1 : 월요일)
  lastDayOfMonth = lastDate.getDay(); // 마지막 날의 요일 출력.
  weekCount = (firstDayOfMonth+daysInMonth)%7 === 0? Math.floor((firstDayOfMonth+daysInMonth)/7) : Math.floor(((firstDayOfMonth+daysInMonth)/7))+ 1;
  
  // 선택된 연도와 월 표시하기
  document.querySelector('.yearMonth').textContent = `${chosenYear} 년 ${chosenMonth + 1} 월`;

  let calendarBody = document.getElementById('calendar-body');
  calendarBody.innerHTML = '';

  let date = 0;
  for(let i = 0; i < weekCount; i++){
    let row = document.createElement("tr");
    for(let j = 1; j <= 7; j++){
      let cell = document.createElement("td");
      if(!(i * 7 + j < firstDayOfMonth + 1 || date >= daysInMonth)){
        date++;
        let cellContent = document.createElement("div");
        cellContent.textContent = date;
        cellContent.classList.add("dates");
        cell.appendChild(cellContent);
        cell.setAttribute('data-date', date); // 날짜 데이터 추가
        cell.addEventListener('click', (event) => {
          chosenDate = new Date(chosenYear, chosenMonth, parseInt(event.target.getAttribute('data-date')));
          console.log(`chosenDate is now : ${chosenDate}`);
        });
      }
      row.appendChild(cell);
    }
    calendarBody.appendChild(row);
  }
}

const previousMonth = () =>{
  chosenMonth--;
  if(chosenMonth < 0){
    chosenMonth = 11;
    chosenYear--;
  }

  renderCalendar();
}

const nextMonth = () => {
  chosenMonth++;
  if (chosenMonth > 11) {
    chosenMonth = 0;
    chosenYear++;
  }
  renderCalendar();
}
//최초 입장 시 달력 출력.
renderCalendar();

</script>
<script src="/main/static/js/NAV.js"></script>
</body>
</html>